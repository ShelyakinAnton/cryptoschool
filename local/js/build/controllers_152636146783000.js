APP=window.APP||{},APP.Helpers=APP.Helpers||{},APP.Controls=APP.Controls||{},APP.Controls.Page=APP.Controls.Page||{};
!function(){"use strict";can.Control.extend({pluginName:"eyeToggle",defaults:{findInput:"input",eyeSelector:".js-toggle-eye",toggleClassName:"close",typePass:"password",typeText:"text",typeAttr:"type"}},{init:function(){this.toggleType()},update:function(){this.toggleType()},click:function(){var t=this.element.siblings(this.options.findInput),e=t.attr(this.options.typeAttr);e==this.options.typePass?e=this.options.typeText:e==this.options.typeText&&(e=this.options.typePass),t.attr("type",e),this.toggleType()},toggleType:function(){var t=this.element.siblings(this.options.findInput),e=t.attr(this.options.typeAttr);e==this.options.typePass?this.element.addClass(this.options.toggleClassName):this.element.removeClass(this.options.toggleClassName)}})}(jQuery,window.APP);
!function(){"use strict";can.Control.extend({pluginName:"clearForm",defaults:{findQuery:'input[type!="hidden"], textarea, select'}},{init:function(){this.clearInput()},update:function(){this.clearInput()},clearInput:function(){var e=this.element.find(this.options.findQuery);e.val("").change(),e.prop("checked",!1)}})}(jQuery,window.APP);
!function(e,t){"use strict";t.Helpers.isValidSelector=function(t){try{{e(t)}}catch(r){return!1}return!0},t.Helpers.clearErrorForm=function(e,t,r){if(t=t||".form-row",r=r||".js-error-message-text","FORM"===e.prop("tagName")){var o=e.find(t);o.removeClass("error"),o.find(r).html("")}else if(e.length>=1){var o=e.closest(t);o.removeClass("error"),o.find(r).html("")}},t.Helpers.initSelect2=function(r,o){var n=e.extend({language:"ru",minimumResultsForSearch:1/0,placeholder:r.data("placeholder"),width:"100%",dropdownCssClass:o.dropdownCssClass,custom:new Select2Custom,closeOnSelect:!r.get(0).multiple,templateSelection:t.Helpers.formatState},o);r.select2(n)},t.Helpers.formatState=function(t){if(!t.id)return t.text;var r=e(t.element);return"undefined"!=typeof r.data("message")?e(r.data("message")):t.text},t.Helpers.isTouch=function(){return!e("html").hasClass("bx-no-touch")},t.Helpers.queryString=function(){for(var e={},t=window.location.search.substring(1),r=t.split("&"),o=0;o<r.length;o++){var n=r[o].split("=");if("undefined"==typeof e[n[0]])e[n[0]]=decodeURIComponent(n[1]);else if("string"==typeof e[n[0]]){var s=[e[n[0]],decodeURIComponent(n[1])];e[n[0]]=s}else e[n[0]].push(decodeURIComponent(n[1]))}return e}(),t.Helpers.openFancy=function(r){var o={href:r,autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,padding:0,beforeLoad:function(){t.scrollY=window.scrollY},afterShow:function(){e.fancybox.update(),setTimeout(function(){var r=e(this).attr("href");!t.Helpers.isValidSelector(r)}.bind(this),300)},afterClose:function(){setTimeout(function(){window.scrollTo(0,t.scrollY)},500);var r=e(this).attr("href");!t.Helpers.isValidSelector(r)},helpers:{overlay:{locked:!0},title:null}};e.fancybox.open(o)}}(jQuery,window.APP);
!function(t,e,a){"use strict";e.Controls.AjaxScroll=can.Control.extend({defaults:{events:{getNextPage:"getNextPage"},callback:a}},{init:function(){this.ajaxStart=!1,this._initScrollPage()},_initScrollPage:function(){this.paginator=this.element.find(".js-paginator"),this.customUrl=this.paginator.data("url"),this.pagen="PAGEN_"+this.paginator.data("pagen"),this.$loader=this.element.find(".js-loader "),this.$itemList=this.element.find(".js-item-list"),this.count=parseInt(this.paginator.data("count")),this.nextPage=parseInt(this.paginator.data("next")),this.maxPage=parseInt(this.paginator.data("max")),this.perPage=parseInt(this.paginator.data("perpage")),this.origPerPage=this.$itemList.data("perpage")!==a?parseInt(this.$itemList.data("perpage")):"",this.origPerPage<this.perPage&&(this.maxPage=Math.ceil(this.count/this.origPerPage),this.nextPage>1&&(this.nextPage=this.perPage/this.origPerPage+1)),new e.Controls.ScrollPage(this.element,{$nextPageElement:this.element})},"{events.getNextPage}":function(){this._isNextPage()&&!this.ajaxStart&&(this.ajaxStart=!0,this.$loader.addClass("active"),this._makeAjax())},_makeAjax:function(e){t.ajax({url:this.customUrl,type:"post",dataType:"html",data:this._getRequestData(e),success:this.proxy("_onAjaxSuccess",e)})},_getRequestData:function(t){var e={ajaxRequest:!0,reset:t};return e[this.pagen]=parseInt(this.nextPage),e},_onAjaxSuccess:function(t,e){this.$itemList.append(e),"undefined"!=typeof this.options.callback&&this.options.callback(),this.ajaxStart=!1,this.updatePagInfo(),this.updateHistory(),this.$loader.removeClass("active")},_isNextPage:function(){return!!parseInt(this.nextPage)},updatePagInfo:function(){this.nextPage<this.maxPage?this.nextPage++:this.nextPage=""},updateHistory:function(){}})}(jQuery,APP);
!function(t,e,n){"use strict";e.Controls.CommentBlock=can.Control.extend({defaults:{commentForm:".js-form-comment",commentList:".js-comment-list",commentItem:".js-comment-item",commentDelete:".js-comment-delete",commentAnswer:".js-comment-answer",commentAnswerForm:".js-comment-answer-form",commentEdit:".js-comment-edit",commentEditForm:".js-comment-edit-form",commentText:".js-comment-block-item-text",hiddenWrap:".js-hidden-wrap",answerWrap:".js-answer-wrap",commentMore:".js-comment-more",commentAuthInfoBlock:".js-to-comment-auth-info-block",commentAuthInfoLink:".js-to-comment-auth-info-link",animationDuration:300,confirmBtn:".js-confirm"}},{init:function(){new e.Controls.FormComment(this.element.find(this.options.commentForm),{parent:this}),new e.Controls.FormComment(this.element.find(this.options.commentAnswerForm),{parent:this}),new e.Controls.FormComment(this.element.find(this.options.commentEditForm),{parent:this}),this.$list=this.element.find(this.options.commentList),this.deleted=0,this.curPage=parseInt(this.$list.data("page")),this.maxPage=parseInt(this.$list.data("page-cnt")),this.nextPage=this.curPage+1,this.$commentMore=this.element.find(this.options.commentMore),this.$commentAnswerForm=this.element.find(this.options.commentAnswerForm),this.$commentEditForm=this.element.find(this.options.commentEditForm),this.$hiddenWrap=this.element.find(this.options.hiddenWrap),this.options.confirmBtn=this.element.find(this.options.confirmBtn),this.on()},addCommentCallback:function(t){if(t.parent>0){var e=this.$commentAnswerForm.closest(this.options.commentItem),n=this.element.find("#"+e.data("id-for-answer"));n.append(t.item),n.find(this.options.commentItem).eq(-1).slideDown(),this.$commentAnswerForm.appendTo(this.options.hiddenWrap)}else this.$list.prepend(t.item),this.$list.find(this.options.commentItem).eq(0).slideDown()},editCommentCallback:function(t){t.result&&t.parent>0&&(this.element.find(this.options.commentItem).filter("[data-id="+t.parent+"]").find(this.options.commentText).eq(0).html(t.text),this.$commentEditForm.appendTo(this.$hiddenWrap))},"{confirmBtn} click":function(){return"undefined"==typeof this.$elementToDelelete?!1:(t.ajax({url:this.$elementToDelelete.attr("href"),type:"post",dataType:"json"}),this.$elementToDelelete.closest(this.options.commentItem).slideUp(this.options.animationDuration,function(){t(this).remove()}),this.deleted+=1,this.$elementToDelelete=n,t.fancybox.close(),void 0)},"{commentDelete} click":function(t,n){n.preventDefault(),this.$elementToDelelete=t,e.Helpers.openFancy("#popup-confirm-comment")},"{commentAnswer} click":function(t,e){e.preventDefault();var n=t.closest(this.options.commentItem),i=n.find(this.options.answerWrap);i.find(this.options.commentEditForm)&&this.$commentEditForm.appendTo(this.$hiddenWrap),this.$commentAnswerForm.appendTo(n.find(this.options.answerWrap).eq(0)),this.$commentAnswerForm.find("[name=commentParent]").val(n.data("id-for-answer")),this.$commentAnswerForm.find("textarea").focus()},"{commentEdit} click":function(t,e){e.preventDefault();var n=t.closest(this.options.commentItem),i=n.find(this.options.answerWrap);i.find(this.options.commentAnswerForm)&&this.$commentAnswerForm.appendTo(this.$hiddenWrap),this.$commentEditForm.appendTo(n.find(this.options.answerWrap).eq(0)),this.$commentEditForm.find("[name=commentParent]").val(n.data("id")),this.$commentEditForm.find("[name=commentText]").val(n.find(this.options.commentText).eq(0).text()),this.$commentEditForm.find("textarea").focus(),this.$commentEditForm.find("[type=submit]").prop("disabled",!1)},"{commentMore} click":function(e,n){n.preventDefault(),t.ajax({url:e.attr("href"),type:"post",dataType:"json",data:{page:this.nextPage,itemId:e.data("item-id"),deleted:this.deleted},success:this.proxy("moreResultCallback"),error:function(){this.element.find(this.options.commentMore).slideUp(this.options.animationDuration)}.bind(this)})},"{commentAuthInfoLink} click":function(e,n){n.preventDefault(),t.scrollTo(this.element.find(this.options.commentAuthInfoBlock),this.options.animationDuration)},moreResultCallback:function(t){t.result?(this.curPage=this.nextPage,this.nextPage+=1,this.nextPage>this.maxPage&&this.element.find(this.options.commentMore).slideUp(this.options.animationDuration),t.items.length&&(this.$list.append(t.items),this.$list.find(this.options.commentItem).filter('[style="display:none;"]').slideDown(this.options.animationDuration))):this.element.find(this.options.commentMore).slideUp(this.options.animationDuration)}})}(jQuery,APP);
!function(t,e,i){"use strict";e.Controls.Layout=can.Control.extend({defaults:{upButton:".js-up",video:".js-video-overlay",eye:".js-toggle-eye",authorizedBlock:".js-authorized-block",authorizedName:".js-authorized-block-profile-name",authorizedPhoto:".js-authorized-block-profile-img",datepicker:".js-datepicker",datepickerButton:".js-data-picker-button",inlineFancy:".js-inline-popup-link",inlineFancyClass:"active",inlinePopup:".js-inline-popup",tooltip:".js-tooltip",formRegistration:".js-form-registration",formAuth:".js-form-auth",formRemind:".js-form-remind",formChangePass:".js-form-change-pass",headerAuthLink:".js-header-auth-link",headerRegLink:".js-header-reg-link",authLink:".js-auth-link",regLink:".js-reg-link",fancyClose:".js-fancy-close",item:".js-product-item",statusPayed:"F",statusBlocked:"N",statusExt:"Z",classPayed:"payed",classBlocked:"blocked",classExt:"payed",userOrderTypes:["STREAM","WEBINAR","COURSE"],ajaxSubscribe:".js-ajax-subscribe"}},{init:function(){Select2Custom.prototype.resultBind=function(e,s){if(this.resultBinded==i){this.resultBinded=!0;var o=this;o.scrollOptions={scrollInertia:100,scrollbarPosition:"inside",axis:"y",callbacks:{onScroll:function(){if("undefined"!=typeof s.$loadingMore){var e=t.contains(document.documentElement,s.$loadingMore[0]);if(s.loading||!e)return;var i=s.$results.scrollTop()+s.$results.closest(".select2-results").outerHeight(!1),o=s.$loadingMore.position().top+s.$loadingMore.outerHeight(!1);i+50>=o&&s.loadMore()}}}},e.on("results:all",function(){s.$results.closest(".select2-results").mCustomScrollbar("destroy"),s.$results.closest(".select2-results").mCustomScrollbar(o.scrollOptions)}),e.on("results:message",function(){s.$results.closest(".select2-results").mCustomScrollbar("destroy"),s.$results.closest(".select2-results").mCustomScrollbar(o.scrollOptions)}),e.on("results:previous",function(){s.$results.closest(".select2-results").mCustomScrollbar("scrollTo",s.getHighlightedResults().position().top)}),e.on("results:next",function(){s.$results.closest(".select2-results").mCustomScrollbar("scrollTo",s.getHighlightedResults().position().top)}),s.$results.scrollTop=function(){var t=this.closest(".select2-results").find(".mCSB_container");return t.length>0?-t.position().top:0},s.$results.height=function(){var t=this.closest(".select2-results");return t.length>0?t.height():0}}},this.element.find(this.options.upButton).each(function(){new e.Controls.Up(this)}),this.element.find(this.options.eye).eyeToggle(),this.initFancy(),this.$authorizedBlock=this.element.find(this.options.authorizedBlock),this.$authorizedName=this.element.find(this.options.authorizedName),this.$authorizedPhoto=this.element.find(this.options.authorizedPhoto),this.element.find(".js-m-scroll").each(function(){t(this).mCustomScrollbar({scrollbarPosition:"outside",scrollInertia:0,axis:"undefined"!=typeof t(this).data("axis")?t(this).data("axis"):"y",autoDraggerLength:!1,callbacks:{whileScrolling:function(){t(this).data("top",this.mcs.topPct)}}})}),this.element.find("select").each(function(){var i=t(this),s=i.hasClass("js-in-popup")?"in-popup":"";e.Helpers.initSelect2(t(this),{dropdownCssClass:s})}),this.element.find(this.options.datepicker).datetimepicker({widgetPositioning:{horizontal:"auto",vertical:"top"},calendarWeeks:!1,locale:"ru",format:"DD.MM.YYYY",useCurrent:this.element.find(this.options.datepicker).data("use-current")!==!1}),this.$inlinePopup=this.element.find(this.options.inlinePopup),this.$inlineLink=this.element.find(this.options.inlineFancy),this.initForm(),this.initHashPopups(),this.setProductStatuses(),BX.addCustomEvent("onPullEvent",this.pushListener.bind(this))},pushListener:function(t,e){switch(e){case"logoutOther":window.location.href=window.location.href+"?logout=yes"}return!0},click:function(e,s){if(t(s.target).closest(this.options.authorizedBlock).length||this.$authorizedBlock.removeClass("active"),t(s.target).closest(this.options.inlinePopup).length||this.closeInlinePopupAll(),!t(s.target).closest(".select2-container").length){var o=t("select");o.data("select2")!=i&&o.select2("close")}},initFancy:function(){this.element.find(".js-popup-link").each(function(){var i=t(this);i.fancybox({autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,wrapCSS:"undefined"!=typeof i.data("fancy-class")?i.data("fancy-class"):"qweqwe",padding:0,beforeLoad:function(){e.scrollY=window.scrollY},afterShow:function(){t.fancybox.update(),setTimeout(function(){var s=i.attr("href");if(e.Helpers.isValidSelector(s)){var o=t(s);o.find("input[type=text], textarea").first().focus()}}.bind(this),300)},afterClose:function(){setTimeout(function(){window.scrollTo(0,e.scrollY)},500);var s=i.attr("href");if(e.Helpers.isValidSelector(s)){var o=t(s).find("form");o.length&&(1==o.data("clear-after")&&(o.find('input[type!="submit"][type!="hidden"][type!="checkbox"] , textarea').val(""),o.find('input[type="checkbox"]').prop("checked",!1)),e.Helpers.clearErrorForm(o))}},helpers:{overlay:{locked:!0},title:null}})})},"{authorizedBlock} click":function(t){t.addClass("active")},"{datepickerButton} touchstart":function(t,e){this.showDatePicker(t,e)},"{datepickerButton} mousedown":function(t,e){this.showDatePicker(t,e)},"{fancyClose} click":function(){t.fancybox.close()},"{datepicker} dp.show":function(e){var s=t(e),o=s.data("DateTimePicker");s.val()||s.data("default")===i||o.date(s.data("default"))},showDatePicker:function(t,e){e.preventDefault();var i=t.siblings(this.options.datepicker),s=t.siblings(".dropdown-menu");i.length&&!s.length?i.data("DateTimePicker").show():i.length&&i.data("DateTimePicker").hide()},"{inlineFancy} click":function(t){return this.openInlinePopup(t),!1},openInlinePopup:function(t){t.hasClass(this.options.inlineFancyClass)||(this.$inlinePopup.hide(),this.$inlineLink.removeClass(this.options.inlineFancyClass),t.addClass(this.options.inlineFancyClass));var e=this.element.find(t.attr("href"));e.length&&e.fadeIn(),e.find("input[type=text], textarea").first().focus()},closeInlinePopupAll:function(){this.$inlinePopup.hide(),this.$inlineLink.removeClass(this.options.inlineFancyClass)},closeInlinePopup:function(t){t.length&&t.fadeOut()},"{tooltip} mouseenter":function(t){t.addClass("active")},"{tooltip} mouseleave":function(t){t.removeClass("active")},"{authLink} click":function(e,i){i.preventDefault();var s=this.element.find(this.options.headerAuthLink);t.scrollTo(s,{duration:300,onAfter:function(){s.click()}})},"{regLink} click":function(e,i){i.preventDefault();var s=this.element.find(this.options.headerRegLink);t.scrollTo(s,{duration:300,onAfter:function(){s.click()}})},initForm:function(){new e.Controls.FormRegistration(this.element.find(this.options.formRegistration)),new e.Controls.FormAuth(this.element.find(this.options.formAuth)),new e.Controls.FormRemind(this.element.find(this.options.formRemind)),new e.Controls.FormChangePass(this.element.find(this.options.formChangePass))},initHashPopups:function(){if(!location.hash.length)return!1;if("#register"==location.hash){var t=this.element.find("#popup-registration-inline");t.length&&e.Helpers.openFancy("#"+t.attr("id"))}if("#login"==location.hash){var t=this.element.find("#popup-authorize-inline");t.length&&e.Helpers.openFancy("#"+t.attr("id"))}"#subscribe"==location.hash&&setTimeout(function(){this.$ajaxSubscribeBtn=this.element.find(this.options.ajaxSubscribe),this.$ajaxSubscribeBtn.length&&this.$ajaxSubscribeBtn.eq(0).click()}.bind(this),1500)},setProductStatuses:function(){if("undefined"==typeof e.USER.ORDERS)return!1;var i=e.USER.ORDERS;t(this.options.item).each(function(e,s){var o,n=t(s).data("id"),a=t(s).data("course-id");for(o=0;o<this.options.userOrderTypes.length;++o){var l=this.options.userOrderTypes[o];"undefined"==typeof i[l]||"undefined"==typeof i[l][n]&&"undefined"==typeof i[l][a]||(i[l][n]==this.options.statusPayed||i[l][a]==this.options.statusPayed?t(s).addClass(this.options.classPayed):(i[l][n]==this.options.statusBlocked||i[l][a]==this.options.statusBlocked)&&t(s).addClass(this.options.classBlocked))}}.bind(this))},changeName:function(t){this.$authorizedName.html(t)},changePhoto:function(t){t?(this.$authorizedPhoto.removeClass("img no-photo header-auth"),this.$authorizedPhoto.attr("style","background-image: url("+t+");")):(this.$authorizedPhoto.addClass("img no-photo header-auth"),this.$authorizedPhoto.attr("style",""))},"dp.show":function(){t(".bootstrap-datetimepicker-widget [title='Select Decade']").removeAttr("data-action")}})}(jQuery,APP);
!function(t,e,a){"use strict";e.Controls.Form=can.Control.extend({defaults:{formRow:".form-row",errorContainer:".js-error-message-text"}},{fieldNames:[],$fields:{},validateRules:{},validateMessages:{},values:{},redirectHref:!1,init:function(){var e=this.element.data("redirect-href");if(this.okPopup=this.element.data("ok-popup"),this.clearAfter=this.element.data("clear-after")==a?!0:this.element.data("clear-after"),e!==a&&(this.redirectHref=e),this.$ajaxLoader=this.element.find(".ajax-loader"),this.action=this.element.attr("action"),this.element.lockTab(),this.setFields(),this.addValidators(),this.setValidateOptions(),this._validate(),this.element.data("show")){var i=this.element.closest(".popup");i.length>0&&t.fancybox({href:"#"+i.attr("id"),afterShow:this.proxy("_callbackAfterShowPopup"),afterClose:this.proxy("_callbackAfterClosePopup"),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,padding:0})}},_validate:function(){this.validator=this.element.validate({ignore:".ignore",invalidHandler:function(t,e){var a=e.numberOfInvalids();a&&e.errorList[0].element.focus()},highlight:function(e){e=t(e),e.closest(this.options.formRow).removeClass("valid").addClass("error")}.bind(this),unhighlight:function(e){e=t(e),e.closest(this.options.formRow).removeClass("error").addClass("valid"),e.closest(this.options.formRow).find(this.options.errorContainer).html(""),e.trigger("checkError")}.bind(this),errorPlacement:function(e,a){a=t(a),a.closest(this.options.formRow).find(this.options.errorContainer).html(e.text()),a.trigger("checkError")}.bind(this),submitHandler:this.proxy("submitHandler"),rules:this.validateRules,messages:this.validateMessages})},_callbackAfterShowPopup:function(){this.element.find('input[type!="hidden"], textarea, select').first().focus()},_callbackAfterClosePopup:function(){var a=t(this).attr("href"),i=t(a).find("form");i.length&&(i.clearForm(),e.Helpers.clearErrorForm(i))},setFields:function(){this.element.find("[data-js-validate]").each(this.proxy(function(e,a){var i=t(a);if("1"==i.data("js-validate")){var s=i.attr("name");this.fieldNames.push(),this.$fields[s]=i}}))},setValidateOptions:function(){this.validateRules={},this.validateMessages={},t.each(this.$fields,this.proxy(function(t,e){this.validateRules[t]={required:e.data("required"),minlength:e.data("min-length"),maxlength:e.data("max-length"),customEmail:!!e.data("email"),customPhone:!!e.data("phone"),onlyEn:!!e.data("only-en"),equalTo:e.data("equal-to"),notEqual:e.data("not-equal"),valueNotEquals:e.data("value-not-equals"),digits:e.data("digits")},this.validateMessages[t]={required:e.data("required-msg"),minlength:e.data("min-length-msg"),maxlength:e.data("max-length-msg"),customEmail:e.data("email-msg"),customPhone:e.data("phone-msg"),onlyEn:e.data("only-en-msg"),password:e.data("password-msg"),equalTo:e.data("equal-to-msg"),notEqual:e.data("not-equal-msg"),valueNotEquals:e.data("value-not-equals-msg"),digits:e.data("digits-msg")}}))},getValues:function(){return this.element.serialize()},submitHandler:function(){return this.$ajaxLoader.show(),t.ajax({url:this.action,type:"post",dataType:"json",data:this.getValues(),success:this.proxy("submitResult")}),!1},submitResult:function(t){if(this.$ajaxLoader.hide(),t.result)this.clearAfter&&this.element.clearForm(),e.Helpers.clearErrorForm(this.element),this.successCallback(t);else if(t.errorFields&&t.errorFields.length>0)for(var a=0;a<t.errorFields.length;a++){var i=this.element.find("#"+t.errorFields[a].fieldId),s=i.closest(this.options.formRow);s.removeClass("valid").addClass("error"),s.find(this.options.errorContainer).html(t.errorFields[a].message),0==a&&i.focus()}t.errorFields&&t.errorFields.length||this.showPopup(t)},successCallback:function(){},showPopup:function(a){if(this.okPopup.length){var i="#"+this.okPopup,s=t(i);if(!s.length)return!0;s.find(".js-success-title").html(a.message.title),s.find(".js-success-text").html(a.message.text),this.closeFancyTimeout=a.message.text.length/10*1e3,this.closeFancyTimeout<4e6&&(this.closeFancyTimeout=4e6),t.fancybox({href:i,afterClose:function(){clearTimeout(e.fancyTimeOut),0!=this.redirectHref&&a.result&&this.redirect(),s.removeClass("visible")}.bind(this),afterShow:function(){s.addClass("visible"),this.callbackFancyboxAfterShow()}.bind(this),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,padding:0}),e.fancyTimeOut=setTimeout(this.proxy(function(){t.fancybox.close(),0!=this.redirectHref&&a.result&&this.redirect()}),this.closeFancyTimeout)}else 0!=this.redirectHref&&a.result&&this.redirect()},callbackFancyboxAfterShow:function(){},redirect:function(){"reload"==this.redirectHref?document.location.reload():this.redirectHref!==!1&&"false"!==this.redirectHref&&(document.location.href=this.redirectHref)},addValidators:function(){t.validator.addMethod("customEmail",function(t){return/^([a-zA-Z0-9_\.\-+])+\@(([a-zA-Z0-9_\-\.])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)}),t.validator.addMethod("customPhone",function(t){return t.length?/^\+?([0-9])+$/.test(t):!0}),t.validator.addMethod("onlyEn",function(t){return/^[a-z0-9-_\.]+$/i.test(t)}),t.validator.addMethod("notEqual",function(e,a,i){return this.optional(a)||e!=t(i).val()}),t.validator.addMethod("valueNotEquals",function(t,e,a){return a!=t})},"input keyup":function(e,a){27==a.keyCode&&t.fancybox.close()}})}(jQuery,window.APP);
!function(e,t,o){"use strict";t.Controls.FormAuth=t.Controls.Form.extend({defaults:{closePopupBtn:".js-close",headerAuthLink:".js-header-auth-link"}},{successCallback:function(){},"{closePopupBtn} click":function(){var t=e(this.options.headerAuthLink);t!==o&&(t.removeClass("active"),e(t.attr("href")).hide())}})}(jQuery,window.APP);
!function(o,n){"use strict";n.Controls.FormRegistration=n.Controls.Form.extend({successCallback:function(){}})}(jQuery,window.APP);
!function(t,s){"use strict";s.Controls.FormRegistrationTwoSteps=s.Controls.Form.extend({defaults:{firstStepButton:".js-first-step",finishStepButton:".js-finish-step",pass:".js-password",step:".js-step",stateCurrent:".js-progress-state-current"}},{init:function(){this._super(),this.curState=1,this.$stateCurrent=this.element.find(this.options.stateCurrent)},"{firstStepButton} click":function(){this.element.valid()&&this.submitHandler()},submitHandler:function(){return this.$ajaxLoader.show(),t.ajax({url:this.action,type:"post",dataType:"json",data:this.getValues(),success:this.proxy("submitResult")}),!1},submitResult:function(t){if(this.$ajaxLoader.hide(),t.result)this.successCallback(t);else if(t.errorFields&&t.errorFields.length>0)for(var s=0;s<t.errorFields.length;s++){var e=this.element.find("#"+t.errorFields[s].fieldId),i=e.closest(this.options.formRow);i.removeClass("valid").addClass("error"),i.find(this.options.errorContainer).html(t.errorFields[s].message),0==s&&e.focus()}},successCallback:function(t){1==this.curState?(this.element.find(this.options.pass).removeClass("ignore"),this.element.removeClass("step-one").addClass("step-two"),this.$stateCurrent.text(2),this.curState=2,this.element.find(this.options.step).val(2)):(this.element.removeClass("step-two").addClass("step-finish"),t.errorFields&&t.errorFields.length||setTimeout(function(){this.showPopup(t)}.bind(this),2e3))}})}(jQuery,window.APP);
!function(n,o){"use strict";o.Controls.FormRemind=o.Controls.Form.extend({successCallback:function(){}})}(jQuery,window.APP);
!function(n,o){"use strict";o.Controls.FormChangePass=o.Controls.Form.extend({successCallback:function(){}})}(jQuery,window.APP);
!function(t,e,i){"use strict";e.Controls.FormComment=e.Controls.Form.extend({defaults:{parent:i}},{init:function(){this._super(),this.$formSubmit=this.element.find('[type="submit"]')},"textarea keyup":function(t){t.val().length?this.$formSubmit.removeAttr("disabled"):this.$formSubmit.attr("disabled","")},successCallback:function(t){"undefined"!=typeof this.options.parent&&(this.$formSubmit.attr("disabled",""),"undefined"!=typeof t.type&&"edit"==t.type?this.options.parent.editCommentCallback(t):this.options.parent.addCommentCallback(t))}})}(jQuery,window.APP);
!function(t,s,e){"use strict";s.Controls.FormSearch=s.Controls.Form.extend({defaults:{qInput:".js-question",delay:500,parent:e}},{_validate:function(){this.validator=this.element.validate({invalidHandler:function(t,s){var e=s.numberOfInvalids();e&&s.errorList[0].element.focus()},highlight:function(s){s=t(s),s.closest(this.options.formRow).removeClass("valid").addClass("error")}.bind(this),unhighlight:function(s){s=t(s),s.closest(this.options.formRow).removeClass("error").addClass("valid"),s.closest(this.options.formRow).find(this.options.errorContainer).html(""),s.trigger("checkError")}.bind(this),errorPlacement:function(s,e){e=t(e),e.closest(this.options.formRow).find(this.options.errorContainer).html(s.text()),e.trigger("checkError")}.bind(this),rules:this.validateRules,messages:this.validateMessages})},"{qInput} input":function(t){"undefined"!=typeof this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.element.valid()&&(t.val()?this.search():this.options.parent.updateList("all"))}.bind(this),this.options.delay)},search:function(){t.ajax({url:this.element.data("process-url"),type:"post",dataType:"json",data:this.getValues(),success:this.proxy("searchResult")})},searchResult:function(t){this.options.parent!==e&&this.options.parent.updateList(t)}})}(jQuery,window.APP);
!function(t,e,n){"use strict";e.Controls.FormQuestion=e.Controls.Form.extend({defaults:{name:".js-question-name",email:".js-question-email"}},{successCallback:function(){this.populateFormData()},populateFormData:function(){e.USER.NAME!=n&&this.element.find(this.options.name).val(e.USER.NAME),e.USER.EMAIL!=n&&this.element.find(this.options.email).val(e.USER.EMAIL)}})}(jQuery,window.APP);
!function(t,i){"use strict";i.Controls.FormPersonalData=i.Controls.Form.extend({init:function(){this._super(),this.uploadBlock=this.element.find(".js-upload-block"),this.$submit=this.element.find("[type=submit]"),new i.Controls.UploadBlock(this.uploadBlock)},successCallback:function(t){"undefined"!=typeof t.name&&i.layout.changeName(t.name),this.$submit.prop("disabled",!0).attr("title",this.$submit.data("title"))},"input, textarea input":function(){this.updateSumbit()},"select, input[type=radio]  change":function(){this.updateSumbit()},"dp.change":function(){this.updateSumbit()},updateSumbit:function(){var t=this.validator.checkForm();this.$submit.prop("disabled",!t).attr("title",t?"":$submit.data("title"))}})}(jQuery,window.APP);
!function(n,t){"use strict";t.Controls.FormPersonalChangePass=t.Controls.Form.extend({successCallback:function(){},"input input":function(){this.element.find("[type=submit]").prop("disabled",!this.validator.checkForm())}})}(jQuery,window.APP);
!function(e,s,i){"use strict";s.Controls.FormWebinar=s.Controls.Form.extend({defaults:{eye:".js-toggle-eye",infoMessage:".js-info-message-text"}},{init:function(){this._super(),this.element.find(this.options.eye).eyeToggle()},successCallback:function(){},"input focus":function(e){e.parent().siblings(this.options.infoMessage).show()},"input blur":function(e){e.parent().siblings(this.options.infoMessage).hide()},"{closePopupBtn} click":function(){var s=e(this.options.headerAuthLink);s!==i&&(s.removeClass("active"),e(s.attr("href")).hide())}})}(jQuery,window.APP);
!function(e,s,t){"use strict";s.Controls.FormStream=s.Controls.Form.extend({defaults:{eye:".js-toggle-eye",infoMessage:".js-info-message-text"}},{init:function(){this._super(),this.element.find(this.options.eye).eyeToggle()},successCallback:function(){},"input focus":function(e){e.parent().siblings(this.options.infoMessage).show()},"input blur":function(e){e.parent().siblings(this.options.infoMessage).hide()},"{closePopupBtn} click":function(){var s=e(this.options.headerAuthLink);s!==t&&(s.removeClass("active"),e(s.attr("href")).hide())}})}(jQuery,window.APP);
!function(t,n,e){"use strict";n.Controls.FormFullName=n.Controls.Form.extend({defaults:{parent:e}},{init:function(){this._super()},successCallback:function(n){n.result&&(location.href=n.certUrl),t.fancybox.close(),this.options.parent!=e&&this.options.parent.forceCertLinks()},populateStream:function(t){this.element.find(".js-stream-input").val(t)}})}(jQuery,window.APP);
!function(t,i){"use strict";i.Controls.Up=can.Control.extend({defaults:{visibleClass:"vis",show:400}},{init:function(){this.reInit()},reInit:function(){this.position=this.element.offset().top,this.footerHeight=t("footer").outerHeight(),t(window).scrollTop()>this.options.show?this.element.addClass(this.options.visibleClass):this.element.removeClass(this.options.visibleClass),this.position<t(document).height()-this.footerHeight?this.element.removeClass("footer"):this.element.addClass("footer"),window.innerWidth<1280?this.element.addClass("small-window"):this.element.removeClass("small-window")},click:function(){t.scrollTo(0,500)},"{window} resize":function(){this.reInit()},"{window} scroll":function(){this.reInit()}})}(jQuery,APP);
!function(t,i){"use strict";i.Controls.ProductBlock=can.Control.extend({defaults:{element:".js-product-item",smallClass:".short-part",heightContainer:".js-height-container",col:".js-col"}},{init:function(){this.$items=this.element.find(this.options.element),this.$cols=this.element.find(this.options.col),this.$smallCardContainters=this.$items.filter(this.options.smallClass).find(this.options.heightContainer),this.$bigCardContainters=this.$items.not(this.options.smallClass).find(this.options.heightContainer),this.reInit()},reInit:function(){this.processHeight(this.$smallCardContainters),this.processHeight(this.$bigCardContainters),this.processCols(this.$cols)},getMaxHeight:function(i){if(!i.length)return!1;var s=0;return i.each(function(){var i=t(this).outerHeight();i>s&&(s=i)}),s},setMaxHeight:function(i,s){return i.length?(i.each(function(){t(this).outerHeight(s)}),void 0):!1},processHeight:function(t){var i=this.getMaxHeight(t);this.setMaxHeight(t,i)},processCols:function(t){if(2!=t.length)return!1;var i=t.eq(0).outerHeight()-t.eq(1).outerHeight();i>0?this.processCol(t.eq(1),Math.abs(i)):0>i&&this.processCol(t.eq(0),Math.abs(i))},processCol:function(i,s){var e=i.find(this.options.heightContainer);if(!e.length)return!1;var n=Math.round(s/e.length);e.each(function(){t(this).css({height:t(this).outerHeight()+n,maxHeight:t(this).outerHeight()+n})})},"{window} resize":function(){this.reInit()}})}(jQuery,APP);
!function(t,s,e){"use strict";s.Controls.StreamBlock=can.Control.extend({defaults:{smile:".js-smile",placeholder:".js-placeholder",msgTemplate:"#msgTemplate",chatBlockWrap:".js-chat-block-list-wrapper",chatBlock:".js-chat-block-list",chatSubmit:".js-chat-submit",disabledClass:"disabled",smileButton:".js-smile-button",smilePopup:".js-smile-popup",questionBtn:".js-question-btn",chatMessageInput:".js-chat-message-input",questionClass:"question",chatMessageDel:".js-chat-message-del",chatMessage:".js-chat-message",banLink:".js-ban-user",bannedClass:"banned",leftSideBlockWrap:".js-left-side-block-wrap",videoInnerBlock:"#video-container",liveCountBtn:".js-live-count-btn",liveCountNumber:".js-live-count-number",liveInterval:6e4}},{init:function(){this.smiles=[];for(var t=1;80>=t;t++)this.smiles.push("knower-smile-"+t);this.$placeholder=this.element.find(this.options.placeholder),this.initTiny(),this.messageOffset=0,this.canGetMessages=!0,this.$chatBlockWrap=this.element.find(this.options.chatBlockWrap),this.$chatBlock=this.element.find(this.options.chatBlock),this.addMsgUrl=this.$chatBlock.data("add-url"),this.delMsgUrl=this.$chatBlock.data("del-url"),this.banUserUrl=this.$chatBlock.data("ban-url"),this.getMsgUrl=this.$chatBlock.data("get-url"),this.chatLiveScriptUrl=this.$chatBlock.data("chat-live-script-url"),this.chatId=this.$chatBlock.data("chat-id"),this.userId=this.$chatBlock.data("user-id"),this.$chatSubmit=this.element.find(this.options.chatSubmit),this.$chatMessageInput=this.element.find(this.options.chatMessageInput),this.$smilePopup=this.element.find(this.options.smilePopup),this.$leftSideBlockWrap=this.element.find(this.options.leftSideBlockWrap),this.$msgs={},BX.onCustomEvent(window,"onPullInit",[]),BX.addCustomEvent("onPullEvent",this.pushHandler.bind(this)),BX.addCustomEvent("onPullStatus",function(t){"online"==t&&this.getChatMessages()}.bind(this)),this.initScroll(),this.makeLiveResponse(),setInterval(function(){this.makeLiveResponse()}.bind(this),this.options.liveInterval)},"{smile} click":function(t){var s=t.data("class");this.tiny.execCommand("mceInsertContent",!1,"["+s+"]"),this.$chatSubmit.removeClass(this.options.disabledClass)},"{questionBtn} click":function(){this.$chatMessageInput.toggleClass(this.options.questionClass)},"{chatMessageDel} click":function(t,s){s.preventDefault();var e=t.closest(this.options.chatMessage);e.length&&this.send(this.delMsgUrl,{id:e.attr("id"),chatId:this.chatId})},"{smileButton} mouseenter":function(t){"undefined"!=typeof this.hidePopup&&clearTimeout(this.hidePopup),t.addClass("active"),this.$smilePopup.mCustomScrollbar({scrollbarPosition:"outside",scrollInertia:0,axis:"y",theme:"gray"})},"{smileButton} mouseleave":function(t){this.hidePopup=setTimeout(function(){t.removeClass("active")}.bind(this),300)},"{chatSubmit} click":function(t,s){if(s.preventDefault(),!t.hasClass(this.options.disabledClass)){var e=this.getMsgContent();e.length&&(this.send(this.addMsgUrl,{html:e,chatId:this.chatId,type:this.$chatMessageInput.hasClass(this.options.questionClass)?this.options.questionClass:""}),this.clearInput())}},"{banLink} click":function(t,s){s.preventDefault();var e=t.closest(this.options.chatMessage);return this.$messages=this.element.find(this.options.chatMessage),e.data("user-id")==this.userId?!1:(e.hasClass(this.options.bannedClass)?(this.send(this.banUserUrl,{id:e.data("user-id"),ban:0}),this.$messages.attr("title",t.data("ban")).removeClass(this.options.bannedClass)):(this.send(this.banUserUrl,{id:e.data("user-id"),ban:1}),this.$messages.attr("title",t.data("unban")).addClass(this.options.bannedClass)),void 0)},"{liveCountBtn} click":function(t,s){s.preventDefault(),t.hasClass("active")?t.removeClass("active"):(t.addClass("disabled"),this.getLiveCount())},reInitSubmitBtn:function(){this.getMsgContent()?this.$chatSubmit.removeClass(this.options.disabledClass):this.$chatSubmit.addClass(this.options.disabledClass)},initTiny:function(){tinymce.init({selector:this.options.chatMessageInput,forced_root_block:"",inline:!0,setup:function(t){t.on("click",this.hidePlaceholder.bind(this)),t.on("beforeSetContent",this.hidePlaceholder.bind(this)),t.on("init",function(){t.getContent()||this.showPlaceholder()}.bind(this)),t.on("blur",function(){t.getContent()||this.showPlaceholder()}.bind(this)),t.on("keydown",this.keydown.bind(this)),t.on("input",this.reInitSubmitBtn.bind(this)),t.on("mouseUp",this.reInitSubmitBtn.bind(this))}.bind(this),menubar:!1,statusbar:!1,placeholder:"Введите сообщение",toolbar:!1,plugins:"autoresize",autoresize_max_height:110,autoresize_min_height:24,object_resizing:!1,valid_elements:"@[src],img,br,span",external_plugins:{knower:"/local/js/libs/stream/tinymce.js"},smiles:this.smiles,relative_urls:!1,skin:!1,skin_url:!1,init_instance_callback:function(t){this.tiny=t}.bind(this)})},initScroll:function(){this.$chatBlockWrap.mCustomScrollbar({scrollbarPosition:"outside",scrollInertia:0,axis:"undefined"!=typeof t(this).data("axis")?t(this).data("axis"):"y",autoDraggerLength:!1,mouseWheel:{scrollAmount:75},callbacks:{whileScrolling:function(){t(this).data("top",this.mcs.topPct)},onTotalScrollBack:function(){this.$chatBlockWrap.mCustomScrollbar("scrollTo",[1],{moveDragger:!1,scrollInertia:100}),this.canGetMessages&&this.getChatMessages()}.bind(this)}})},keydown:function(t){13!==t.keyCode||t.ctrlKey||(t.preventDefault(),this.$chatSubmit.click())},hidePlaceholder:function(){this.$placeholder.addClass("hid")},showPlaceholder:function(){this.$placeholder.removeClass("hid")},pushHandler:function(t,s,e){switch(s){case"add":e.chatId==this.chatId&&this.onAddMsg(e);break;case"del":this.onDelMsg(e);break;case"ban":this.onBanUser(e)}return!0},onBanUser:function(){location.reload()},onDelMsg:function(t){this.delMsg(t.id)},delMsg:function(t){var s=this.element.find(this.options.chatMessage).filter("#"+t);s.length&&s.remove()},timeFromStamp:function(t){return moment(1e3*t).format("HH:mm")},onAddMsg:function(s){this.userId==s.userId&&(s.msgClass+=" right");var i=this.viewMsg(s.id,s.userName,s.userId,this.timeFromStamp(s.timestamp),s.html,s.msgClass),n=t(i);n.length&&(this.$msgs[s.id]=n,this.$chatBlock.append(n)),this.$chatBlockWrap.data("top")!==e&&"100"==this.$chatBlockWrap.data("top")&&this.$chatBlockWrap.mCustomScrollbar("scrollTo","bottom")},onGetMsg:function(s){return"undefined"!=typeof s.messages&&s.messages.length?(s.messages.forEach(function(s){if(s.UF_CHAT_ID==this.chatId){this.userId==s.UF_USER_ID&&(s.UF_CLASS+=" right");var e=this.viewMsg(s.ID,s.UF_USER_NAME,s.UF_USER_ID,this.timeFromStamp(s.UF_TIMESTAMP),s.UF_DESCRIPTION,s.UF_CLASS),i=t(e);i.length&&(this.$msgs[s.ID]=i,this.$chatBlock.prepend(i))}}.bind(this)),this.messageOffset||this.$chatBlockWrap.mCustomScrollbar("scrollTo","bottom"),this.messageOffset+=1,this.canGetMessages=!0,void 0):(this.canGetMessages=!1,!1)},viewMsg:function(t,s,e,i,n,a){return can.view(this.options.msgTemplate,{id:t,userName:s,userId:e,time:i,html:n,msgClass:a})},send:function(s,e,i){i=i||!1,t.ajax({url:s,data:e,type:"post",beforeSend:!1,success:i})},getMsgContent:function(){return this.tiny.getContent()},clearInput:function(){this.tiny.setContent(""),this.$chatMessageInput.removeClass(this.options.questionClass),this.$chatSubmit.addClass(this.options.disabledClass)},changeFullScreen:function(t){var s=this.element.find(this.options.videoInnerBlock).find("[data-player]").length?this.element.find(this.options.videoInnerBlock).find("[data-player]"):this.element.find(this.options.videoInnerBlock);t?this.$leftSideBlockWrap.appendTo(s):this.$leftSideBlockWrap.appendTo(this.element)},changeUserActive:function(t){t?this.$leftSideBlockWrap.removeClass("user-inactive"):this.$leftSideBlockWrap.addClass("user-inactive")},getChatMessages:function(){return this.canGetMessages?(this.canGetMessages=!1,this.send(this.getMsgUrl,{chatId:this.chatId,offset:this.messageOffset},this.onGetMsg.bind(this)),void 0):!1},makeLiveResponse:function(){t.ajax({method:"post",url:this.chatLiveScriptUrl,data:{chatId:this.chatId,action:"hello"}})},getLiveCount:function(){t.ajax({method:"post",url:this.chatLiveScriptUrl,dataType:"html",data:{chatId:this.chatId,action:"count"},success:function(t){this.element.find(this.options.liveCountNumber).html(t),this.element.find(this.options.liveCountBtn).addClass("active").removeClass("disabled")}.bind(this)})}})}(jQuery,APP);
!function(t,e){"use strict";e.Controls.ScrollPage=can.Control.extend({defaults:{reserveHeight:500,$nextPageElement:!1}},{init:function(){this.tryToLoad()},"{window} scroll":function(){this.tryToLoad()},"{window} resize":function(){this.tryToLoad()},tryToLoad:function(){var e=this.element.offset().top,o=this.element.height(),i=t(window).scrollTop(),n=t(window).height();e+o<i+n+this.options.reserveHeight&&this.options.$nextPageElement.trigger("getNextPage")}})}(jQuery,window.APP);
!function(e,i,s){"use strict";i.Controls.TeacherSlider=can.Control.extend({defaults:{teacherSlides:".js-slides",teacherSlide:".js-slide",secondSlider:".js-second-slider",secondSlideClass:"js-slide",secondSlide:".js-second-slider .js-slide",owlItem:".owl-item",galleryItem:".js-gallery-item",mainImg:".js-img",currentSecondSlideClass:"current"}},{init:function(){this.$teacherSlides=this.element.find(this.options.teacherSlides),this.$teacherSlide=this.$teacherSlides.find(this.options.teacherSlide),this.$teacherSlides.length&&this.$teacherSlides.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:1,center:!1,margin:17,nav:!1,dots:this.$teacherSlide.length>1,dotsEach:1,navRewind:!1,autoWidth:!0}),this.initFancy(),e("body").on("click",this.options.secondSlide,function(i){this.onSecondSlideClick(e(i.target))}.bind(this))},onSecondSlideClick:function(e){var i=e.data("img"),s=e.closest(this.options.galleryItem);s.find(this.options.mainImg).css({backgroundImage:"url("+i+")"}),s.find(this.options.secondSlide).removeClass(this.options.currentSecondSlideClass),e.addClass(this.options.currentSecondSlideClass)},initFancy:function(){var t=this;this.element.find(".js-popup-gallery-link").fancybox({autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,wrapCSS:"course-gallery",padding:0,beforeLoad:function(){i.scrollY==s&&(i.scrollY=window.scrollY)},afterShow:function(){e.fancybox.update();var i=e(this.inner).find(t.options.secondSlider);"undefined"==typeof i.data("owlCarousel")?t.initSecondSlider(i):t.reInitSecondSlider(i)},afterClose:function(){setTimeout(function(){window.scrollTo(0,i.scrollY),i.scrollY=s},500)},helpers:{overlay:{locked:!0},title:null}})},initSecondSlider:function(e){e.owlCarousel({loop:!0,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:6,center:!1,margin:20,nav:!1,dots:!1,navRewind:!1}),e.find(this.options.owlItem).filter(".active").eq(0).find("."+this.options.secondSlideClass).addClass(this.options.currentSecondSlideClass)},reInitSecondSlider:function(e){var i=e.data("owlCarousel");i.onResize()}})}(jQuery,APP);
!function(r,e,t){"use strict";e.Controls.FormOrder=e.Controls.Form.extend({successCallback:function(r){r.redirect!=t&&(this.redirectHref=r.redirect,this.redirect())}})}(jQuery,window.APP);
!function(t,e,i){"use strict";e.Controls.VideoPlayer=can.Control.extend({defaults:{videoContainer:"#video-container",videoContainerId:"video-container",playlistItem:".js-playlist-block-item",streamBlock:i}},{init:function(){if(this.initedList=!1,this.$videoContainer=this.element.find("#"+this.options.videoContainerId),this.$videoContainer.length){if(e.Helpers.isTouch()){var t=this.$videoContainer.find("source");t.attr("src",t.data("mobile-src")!==i?t.data("mobile-src"):t.attr("src")),t.attr("type",t.data("mobile-type")!==i?t.data("mobile-type"):t.attr("type")),this.$videoContainer.data("setup",i),this.player=videojs(this.options.videoContainerId,{html5:{hls:{withCredentials:!0}}})}else this.player=videojs(this.options.videoContainerId,{techOrder:["flash"]});this.options.streamBlock!==i&&(this.player.on("fullscreenchange",function(t){this.options.streamBlock.changeFullScreen(t.target.player.isFullscreen_)}.bind(this)),this.player.on("useractive",function(){this.options.streamBlock.changeUserActive(!0)}.bind(this)),this.player.on("userinactive",function(){this.options.streamBlock.changeUserActive(!1)}.bind(this)))}(this.player!==i&&e.VIDEO_LIST!=i||e.VIDEO_LIST_MOBILE!=i)&&(e.Helpers.isTouch()?this.player.playlist(e.VIDEO_LIST_MOBILE):this.player.playlist(e.VIDEO_LIST),this.initedList=!0,this.$playlistItem=this.element.find(this.options.playlistItem))},"{videoContainer} contextmenu":function(t,e){e.preventDefault()},"{playlistItem} click":function(t,e){e.preventDefault(),this.player!=i&&this.initedList&&(this.player.pause(),this.player.tech_.trigger("seeked"),this.$playlistItem.removeClass("active"),t.addClass("active"),this.player.playlist.currentItem(t.data("index")))}})}(jQuery,APP);
!function(e,t,i){"use strict";t.Controls.VideoPlayerClappr=t.Controls.VideoPlayer.extend({},{init:function(){this.initedList=!1,this.$videoContainer=this.element.find("#"+this.options.videoContainerId),this.$videoContainer.length&&(this.player=new Clappr.Player({language:"en-EN",parentId:"#"+this.options.videoContainerId,source:this.$videoContainer.attr("src"),width:"640",height:"360",autoPlay:!1,preload:"auto",poster:this.$videoContainer.attr("poster"),disableVideoTagContextMenu:!0,mediacontrol:{seekbar:"#03d981",buttons:"#03d981"},plugins:[LevelSelector],levelSelectorConfig:{labelCallback:function(e){return e.level.height+"p"}}}),this.options.streamBlock!==i&&(this.player.on("fullscreen",function(e){this.options.streamBlock.changeFullScreen(e)}.bind(this)),this.player.core.mediaControl.on("mediacontrol:show",function(){this.options.streamBlock.changeUserActive(!0)}.bind(this)),this.player.core.mediaControl.on("mediacontrol:hide",function(){this.options.streamBlock.changeUserActive(!1)}.bind(this)))),this.player!==i&&t.VIDEO_LIST!=i&&(this.initedList=!0,this.$playlistItem=this.element.find(this.options.playlistItem)),window.player=this.player},"{playlistItem} click":function(e,n){if(n.preventDefault(),this.player!=i&&this.initedList){var o=!1;this.isFullscreen()&&(o=!0),this.player.pause();var s=e.data("index");this.$playlistItem.removeClass("active"),e.addClass("active"),void 0!==t.VIDEO_LIST_MOBILE[s].poster&&this.player.configure({poster:t.VIDEO_LIST_MOBILE[s].poster}),this.player.core.load(t.VIDEO_LIST_MOBILE[s].sources[0].src),this.player.play(),o&&setTimeout(function(){player.core.toggleFullscreen()}.bind(this),10)}},isFullscreen:function(){return!!(document.webkitFullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)}})}(jQuery,APP);
!function(i,t){"use strict";t.Controls.UploadBlock=can.Control.extend({defaults:{errorMessage:".js-error-message",img:".js-upload-image",uploadLink:".js-upload-link",confirmBtn:".js-confirm",cropBlock:".js-crop-block",cropPopup:"#popup-crop",cropLink:".js-crop-link"}},{init:function(){this.addFileUrl=this.element.data("add-url"),this.delFileUrl=this.element.data("del-url"),this.$errorMessage=this.element.find(this.options.errorMessage),this.$img=this.element.find(this.options.img),this.$link=this.element.find(this.options.uploadLink),this.cropBLock=new t.Controls.CropBlock(i(this.options.cropBlock),{parent:this}),this.$cropLink=this.element.find(this.options.cropLink),this.initUpload(),this.options.confirmBtn=this.element.find(this.options.confirmBtn),this.on()},initUpload:function(){this.dropzone=new Dropzone(this.options.uploadLink,{url:this.addFileUrl,uploadMultiple:!1,paramName:"file",maxFilesize:5,acceptedFiles:".jpg, .png",previewsContainer:this.options.img,previewTemplate:'<div class="dz-preview preview"></div>',dictFileTooBig:"Файл имеет недопустимый размер, макмимальный размер файла 5Мb",dictInvalidFileType:"Файл имеет недопустимый тип, разрешеные типы .jpg, .png",processing:function(){this.$img.addClass("active")}.bind(this),success:function(i,e){0!=e.result&&(this.$errorMessage.fadeOut(),this.$img.removeClass("no-photo"),this.$img.attr("style","background-image: url("+e.result+");").attr("title",this.$img.data("title-photo")).removeClass("active"),this.$link.html(this.$link.data("text-change")),this.$cropLink.data("image",e.result),this.$cropLink.show(),t.layout.changePhoto(e.result),this.cropBLock.initCropper(e.result),t.Helpers.openFancy(this.options.cropPopup))}.bind(this),error:function(i,t){this.success=!1,this.$errorMessage.text(t).show();var e;return null!=(e=i.previewElement)?e.parentNode.removeChild(i.previewElement):void 0}.bind(this)})},"{img} click":function(i){i.hasClass("no-photo")||i.hasClass("active")||t.Helpers.openFancy("#popup-confirm")},"{confirmBtn} click":function(){this.deleteFromServer(),this.$img.addClass("no-photo"),this.$img.attr("style",""),this.$img.attr("title",this.$img.data("title-no-photo")),this.$link.html(this.$link.data("text-upload")),this.$cropLink.data("image",""),this.$cropLink.hide(),t.layout.changePhoto(""),i.fancybox.close()},"{cropLink} click":function(i,e){e.preventDefault();var o=i.data("image");o&&(this.cropBLock.initCropper(o),t.Helpers.openFancy(this.options.cropPopup))},deleteFromServer:function(){if(this.delFileUrl){var e={sessid:t.USER.sessid};i.ajax({url:this.delFileUrl,type:"post",dataType:"json",data:e})}}})}(jQuery,APP);
!function(e,i,t){"use strict";i.Controls.CropBlock=can.Control.extend({defaults:{parent:t,image:".js-crop-image",preview:".js-preview-image",btn:".js-save"}},{init:function(){this.url=this.element.data("url"),this.$image=this.element.find(this.options.image)},initCropper:function(e){this.$image.prop("src",e),"undefined"!=typeof this.$image.data("cropper")&&this.$image.cropper("destroy"),this.$image.cropper({aspectRatio:1,minContainerWidth:188,minContainerHeight:188,preview:this.options.preview,guides:!1,minCropBoxWidth:10,minCropBoxHeight:10,movable:!1,zoomable:!1})},"{btn} click":function(){this.$image.cropper("getCroppedCanvas").toBlob(function(t){var o=new FormData;o.append("file",t),e.ajax(this.url,{method:"POST",data:o,processData:!1,contentType:!1,success:function(t){i.layout.changePhoto(t.result),e.fancybox.close()}})}.bind(this))}})}(jQuery,APP);
!function(t,s){"use strict";s.Controls.UserStreamList=can.Control.extend({defaults:{tag:".js-user-stream-tag",item:".js-user-stream-item",activeClass:"active"}},{init:function(){this.$tags=this.element.find(this.options.tag),this.$items=this.element.find(this.options.item)},"{tag} click":function(t){t.toggleClass(this.options.activeClass),t.hasClass(this.options.activeClass)?(this.$items.filter("[data-status="+t.data("status")+"]").slideDown(),1==this.$tags.filter("."+this.options.activeClass).length&&this.$items.filter("[data-status!="+t.data("status")+"]").slideUp()):this.$tags.filter("."+this.options.activeClass).length?this.$items.filter("[data-status="+t.data("status")+"]").slideUp():this.$items.slideDown()}})}(jQuery,APP);
!function(s,e){"use strict";e.Controls.SubscribeFree=e.Controls.Form.extend({defaults:{}},{init:function(){this.url=this.element.attr("href")},click:function(s,e){e.preventDefault(),this.makeRequest()},makeRequest:function(){s.ajax({url:this.url,type:"post",dataType:"json",data:{sessid:e.USER.sessid},success:this.proxy("successCallback")})},successCallback:function(s){s.result&&location.reload()}})}(jQuery,window.APP);
!function(e,t){"use strict";t.Controls.GoogleCalendar=can.Control.extend({defaults:{clientId:"1016157890175-pa2emkd2c91mhv2iabqvs34ucmjf11db.apps.googleusercontent.com",apiKey:"AIzaSyDkYHejohdjIwI5pPKeE03FDhUTs7TyjQw",scopes:"https://www.googleapis.com/auth/calendar",googleBtn:".js-google-btn",event:".js-slide"}},{init:function(){this.userCalendar=!1,setTimeout(function(){gapi.client.setApiKey(this.options.apiKey)}.bind(this),1e3)},"{googleBtn} click":function(e){return this.$event=e.closest(this.options.event),gapi.auth.authorize({client_id:this.options.clientId,scope:this.options.scopes,immediate:!1},this.handleAuthResult.bind(this)),!1},handleAuthResult:function(e){e&&!e.error&&(this.userCalendar?this.requestInsert():this.requestCalList())},requestCalList:function(){gapi.client.load("calendar","v3",function(){var e=gapi.client.calendar.calendarList.list();e.execute(function(e){return"undefined"==typeof e.items?(this.showError("Попробуйте позже"),!1):e.items.length?(e.items.forEach(function(e){"reader"!=e.accessRole&&e.primary&&(this.userCalendar=e)}.bind(this)),this.userCalendar?(this.requestInsert(),void 0):(this.showError("У вас нет доступных для записи календарей"),!1)):(this.showError("У вас нет календарей"),!1)}.bind(this))}.bind(this))},requestInsert:function(){return this.$event?(gapi.client.load("calendar","v3",function(){var e=gapi.client.calendar.events.insert({calendarId:this.userCalendar.id,resource:{summary:this.$event.find(".js-event-name").html(),start:{dateTime:this.$event.find(".js-event-time").data("time")},end:{dateTime:this.$event.find(".js-event-time").data("time")}}});e.execute(function(e){"confirmed"==e.status?this.showSuccess(e.htmlLink):this.showError("Попробуйте позже")}.bind(this))}.bind(this)),void 0):!1},showSuccess:function(e){this.showPopup({message:{title:"Событие добавлено!",text:'Перейти к просмотру события можете по этой <a href="'+e+'" target="_blank">ссылке</a>'}})},showError:function(e){this.showPopup({message:{title:"Ошибка",text:e}})},showPopup:function(i){var s="#popup-success",n=e(s);return n.length?(n.find(".js-success-title").html(i.message.title),n.find(".js-success-text").html(i.message.text),this.closeFancyTimeout=i.message.text.length/10*1e3,this.closeFancyTimeout<4e6&&(this.closeFancyTimeout=4e6),e.fancybox({href:s,afterClose:function(){clearTimeout(t.fancyTimeOut),n.removeClass("visible")}.bind(this),afterShow:function(){n.addClass("visible")}.bind(this),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,padding:0}),t.fancyTimeOut=setTimeout(this.proxy(function(){e.fancybox.close()}),this.closeFancyTimeout),void 0):!0}})}(jQuery,APP);
!function(e,i){"use strict";i.Controls.Page.Main=can.Control.extend({defaults:{mainSlides:".js-main-slider .js-slides",reviewSlides:".js-review-slider .js-slides",formRegistration:".js-form-registration",slideGenerateBlock:".js-bg-block",slideGenerateBlockRow:20,slideGenerateBlockColumn:10,endDelay:3e3,startDelay:0,productBlock:".js-product-block",progressBar:".js-progress-bar",progressBarLine:".js-progress-bar-line",progressBarPercent:".js-progress-bar-percent",animates:".js-svg-wrap",animatesClass:"animated",formRegistrationTwoSteps:".js-form-registration-two-steps",subscribeParam:"task",subscribePopup:"#popup-unsubscribe",initedClass:"inited"}},{init:function(){var t=this.element.find(this.options.mainSlides),s=this.element.find(this.options.reviewSlides);this.element.find(this.options.productBlock).each(function(){new i.Controls.ProductBlock(this)}),this.image=new Array,this.imageObj=new Image,this.$mainSlide=t.find(".slide"),t.find(".slide img").each(function(i,t){var s=e(t).data("image-end");"undefined"!=typeof s&&(this.imageObj.src=s)}.bind(this)),this.imageObj.src.length?this.imageObj.onload=function(){this.initPromoSlider(t)}.bind(this):this.initPromoSlider(t),s.length&&s.find(".slide").length>1&&s.owlCarousel({loop:!0,autoplay:!1,items:1,center:!0,margin:70,nav:!0,navText:["",""],dots:!1,navRewind:!1,autoHeight:!1}),new i.Controls.FormRegistrationTwoSteps(this.element.find(this.options.formRegistrationTwoSteps)),void 0!=i.Helpers.queryString&&void 0!=i.Helpers.queryString[this.options.subscribeParam]&&"unsubscribe"==i.Helpers.queryString[this.options.subscribeParam]&&e(this.options.subscribePopup).length&&i.Helpers.openFancy(this.options.subscribePopup)},initPromoSlider:function(t){if(t.length){var s=this;t.owlCarousel({loop:s.$mainSlide.length>1,autoplay:!0,autoplayTimeout:8e3,autoplayHoverPause:!0,responsiveClass:!0,items:1,center:!0,margin:0,mouseDrag:s.$mainSlide.length>1,touchDrag:s.$mainSlide.length>1,nav:!1,dots:s.$mainSlide.length>1,controlsClass:"owl-controls",autoHeight:!0,onInitialized:function(){s.$progressBar=s.element.find(s.options.progressBar),s.$progressBarLine=s.$progressBar.find(s.options.progressBarLine),s.$progressBarPercent=s.$progressBar.find(s.options.progressBarPercent),this.$element.find(".slide").each(function(t,r){var n=e(r);if(i.Helpers.isTouch()){var o=n.find("img");o.attr("src",o.data("image-end"))}else s.createMarkup(n)}),"undefined"!=typeof s.$progressBar&&s.initProgressBar(0)},onTranslate:function(){var e=this.$element.find(".owl-item.active");e.hasClass(s.options.initedClass)||e.addClass(s.options.initedClass).find(".image-hover-block").css({animation:"none",opacity:"0",visibility:"hiddent"})},onTranslated:function(){var e=this.$element.find(".owl-item.active");e.hasClass(s.options.initedClass)?s.reInitProgressBar(100):s.reInitProgressBar(0)}})}},initedSlide:function(e){this.createMarkup(e)},initProgressBar:function(e){this.startProgressBar(e)},createMarkup:function(e){var i=e.find("img");if(0==e.find(this.options.slideGenerateBlock).length){var t=this.createItem(e,this.options.slideGenerateBlockRow,this.options.slideGenerateBlockColumn);t&&(i.after("<div class='js-bg-block' style='position: absolute;top: 0;left: 0;right: 0; bottom: 0; overflow: hidden;'>"+t+"</div>"),i.attr("src",i.data("image-end")))}},createItem:function(e,i,t){var s=e.height(),r=e.width(),n=e.find("img"),o=n.attr("src");if(void 0==o)return!1;for(var a,l,d,p,c,h,g=a=parseInt(r/i),u=l=parseInt(s/t),m=(d=p=0,""),f=c=r-i*a,v=(h=s-t*l,1);t>=v;v++){c=f,h>0?(h--,l=u+1):l=u;for(var b=1;i>=b;b++)c>0?(c--,a=g+1):a=g,m+="<div class='image-hover-block' style='width:"+a+"px; height:"+l+"px; left: "+d+"px;top: "+p+"px;animation-delay: "+this.getRandomInt(this.options.startDelay,this.options.endDelay)+"ms;float: left; position: absolute; overflow: hidden; opacity: 1;background: url("+o+") -"+d+"px -"+p+"px '></div>",d+=a;p+=l,d=0}return m},getRandomInt:function(e,t){return i.Helpers.isTouch()?0:Math.floor(Math.random()*(t-e+1))+e},reInitProgressBar:function(e){clearTimeout(this.tick),this.startProgressBar(e)},startProgressBar:function(e){var t=this;this.percentTime=e,i.Helpers.isTouch()&&(this.percentTime=100),this.isPause=!1,this.tick=setInterval(function(){t.intervalProgressBar(this)},80)},intervalProgressBar:function(){if(this.isPause===!1){this.percentTime+=10/(this.options.endDelay/1e3);var e=parseInt(this.percentTime);this.percentTime>=100&&(this.isPause=!0,e=this.percentTime=100),this.$progressBarPercent.text(e),this.$progressBarLine.css({width:this.percentTime+"%"})}}})}(jQuery,window.APP);
!function(e,t){"use strict";t.Controls.Page.CourseDetail=can.Control.extend({defaults:{courseSliderWrap:".js-course-slider",courseSlides:".js-course-slider .js-slides",courseSlide:".js-course-slide-item",teacherSlider:".js-teacher-slider",mainInfoBlock:".js-main-info-lesson-block",labelBlocked:".js-label-blocked",toggleBlock:".js-toggle-block",toggleBlockBtn:".js-toggle-block-btn",teacherBlock:".js-teacher-block",commentBlock:".js-comment-block",subscribeFreeBtn:".js-subscribe-free",formWebinar:".js-form-webinar",ajaxPopup:".js-popup-link-ajax",headerAuthLink:".js-header-auth-link",authLink:".js-auth-link"}},{init:function(){void 0!==t.COURSE_DETAIL&&this.element.find(this.options.mainInfoBlock).html(can.view("courseDetailMainInfoLesson",{data:t.COURSE_DETAIL})),void 0!==t.COURSE_DETAIL&&void 0!==t.COURSE_DETAIL.BLOCKED.TEXT&&void 0!==t.COURSE_DETAIL.BLOCKED.DATE&&this.element.find(this.options.labelBlocked).html(can.view("labelBlocked",{data:t.COURSE_DETAIL.BLOCKED})),this.$courseSliderWrap=this.element.find(this.options.courseSliderWrap),void 0!==t.COURSE_DETAIL&&void 0!==t.COURSE_DETAIL.EXERCISE&&void 0!==t.COURSE_DETAIL.EXERCISE.ITEMS?(this.$courseSliderWrap.html(can.view("programmeCourse",{data:t.COURSE_DETAIL.EXERCISE})),this.$courseSlide=this.$courseSliderWrap.find(this.options.courseSlide),this.$courseSlides=this.element.find(this.options.courseSlides),this.$courseSlides.length&&this.$courseSlides.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:4,center:!1,margin:20,nav:this.$courseSlide.length>4,navText:["",""],dots:!1,navRewind:!1})):this.$courseSliderWrap.remove(),this.$teacherBlock=this.element.find(this.options.teacherBlock),void 0!==t.COURSE_DETAIL&&void 0!==t.COURSE_DETAIL.TEACHER?(this.$teacherBlock.html(can.view("teacherBlockInfo",{data:t.COURSE_DETAIL.TEACHER})),void 0!==t.COURSE_DETAIL.TEACHER.WORKS&&(this.$teacherBlock.append(can.view("teacherBlockSlider",{data:t.COURSE_DETAIL.TEACHER.WORKS})),this.$teacherBlock.find(this.options.teacherSlider).each(function(){new t.Controls.TeacherSlider(this)}))):this.$teacherBlock.remove(),new t.Controls.CommentBlock(this.element.find(this.options.commentBlock)),this.element.find(".js-popup-video").each(function(){var i=e(this);i.fancybox({autoSize:!0,autoHeight:!0,autoWidth:!0,minWidth:"800px",minHeight:"600px",maxWidth:"100%",maxHeight:"100%",margin:0,href:i.attr("href"),wrapCSS:"undefined"!=typeof i.data("fancy-class")?i.data("fancy-class"):"qweqwe",padding:0,type:"iframe",beforeLoad:function(){t.scrollY=window.scrollY},afterClose:function(){setTimeout(function(){window.scrollTo(0,t.scrollY)},500)},helpers:{overlay:{locked:!0},title:null}})}),this.element.find(this.options.subscribeFreeBtn).each(function(){new t.Controls.SubscribeFree(e(this))}),this.initFancy()},initFancy:function(){this.element.find(this.options.ajaxPopup).each(function(){var i=e(this);i.fancybox({type:"ajax",ajax:{type:"POST"},href:i.attr("href"),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,wrapCSS:"undefined"!=typeof i.data("fancy-class")?i.data("fancy-class"):"qweqwe",padding:0,beforeLoad:function(){t.scrollY=window.scrollY},afterLoad:function(){setTimeout(function(){var e=this.outer.find("form");new t.Controls.FormStream(e),e.find("input[type=text], textarea").first().focus()}.bind(this),300)},afterClose:function(){setTimeout(function(){window.scrollTo(0,t.scrollY)},500);var e=this.outer.find("form"),i=this.outer.find(".js-inline-popup");e.length&&(1==e.data("clear-after")&&(e.find('input[type!="submit"][type!="hidden"][type!="checkbox"] , textarea').val(""),e.find('input[type="checkbox"]').prop("checked",!1)),t.Helpers.clearErrorForm(e)),i.length&&"reload"==i.data("reload")&&document.location.reload()},helpers:{overlay:{locked:!0},title:null}})})},".js-popup-video click":function(){return!1},"{courseSlide} mouseenter":function(){this.$courseSliderWrap.css({zIndex:2})},"{courseSlide} mouseleave":function(){this.$courseSliderWrap.css({zIndex:"auto"})},"{toggleBlockBtn} click":function(e){var t=e.data("target");t.length&&(e.fadeOut(),this.element.find(t).slideDown())},".fancybox-inner {authLink} click":function(i,o){o.preventDefault();var n=this.element.find(this.options.headerAuthLink);t.scrollY=0,e.fancybox.close(),n.click()}})}(jQuery,window.APP);
!function(t,s){"use strict";s.Controls.Page.CourseList=can.Control.extend({defaults:{switchListBlock:".js-switch-list-block"}},{init:function(){this.initAjaxScroll()},initAjaxScroll:function(){void 0!==this.ajaxScroll&&this.ajaxScroll.destroy(),this.ajaxScroll=new s.Controls.AjaxScroll(this.element.find(".js-scroll-page"),{callback:s.layout.setProductStatuses.bind(s.layout)})},submitResult:function(t){this.element.find(this.options.switchListBlock).html(t),this.initAjaxScroll(),s.layout.setProductStatuses()},"[name=radio-course] change":function(s){var i=s.val();return i.length?(t.ajax({url:i,type:"post",dataType:"html",data:{switchType:!0},success:this.proxy("submitResult")}),history.pushState({},"",i),void 0):!0},"{window} popstate":function(){history.back()}})}(jQuery,window.APP);
!function(t,n){"use strict";n.Controls.Page.Pay=can.Control.extend({defaults:{toggleBlock:".js-toggle-radio-block",formAuthPayment:".js-form-auth-payment",formRegPayment:".js-form-registration-payment",formOrder:".js-form-payment-order",formPaymentWrapper:".js-form-payment-wrapper",buttonSubmitPayment:".js-form-payment-submit"}},{init:function(){var n=this.element.find(this.options.toggleBlock).find("input").filter(":checked").data("relation");this.relationList=this.element.find(this.options.toggleBlock).find("input").map(function(){return t(t(this).data("relation"))}).toArray(),this.toggleRelation(n,this.relationList),this.initForm()},"{toggleBlock} input change":function(t){var n=t.data("relation");n.length>0&&this.toggleRelation(n)},toggleRelation:function(n,e){var i=t(n);e=e||this.relationList,t.each(e,function(){this.hide()}),i.show()},initForm:function(){var t=new n.Controls.FormAuth(this.element.find(this.options.formAuthPayment));new n.Controls.FormRegistration(this.element.find(this.options.formRegPayment)),new n.Controls.FormOrder(this.element.find(this.options.formOrder)),t.element.find("input[type=text], textarea").first().focus()},"{buttonSubmitPayment} click":function(){this.element.find(this.options.formPaymentWrapper).find("form").submit()}})}(jQuery,APP);
!function(e,t){"use strict";t.Controls.Page.Profile=can.Control.extend({defaults:{calendar:".js-calendar",calendarNPrev:".js-calendar-nav-prev",calendarNNext:".js-calendar-nav-next",calendarMonthSlider:".js-calendar-month-slider",calendarSlider:".js-calendar-slider",calendarSlide:".js-calendar-slider .calendar-slider-item",date:".js-date",uploadBlock:".js-upload-block",userStreamList:".js-user-stream-list",formFullName:".js-form-full-name",formLink:".js-form-link",forcedLink:".js-forced-link",forcedLinkClass:"js-forced-link",certSliderSlides:".js-cert-slider .js-slides",certSliderSlide:".js-cert-slide-item"}},{init:function(){if(this.$calendar=this.element.find(this.options.calendar),this.$calendarSlide=this.$calendar.find(this.options.calendarSlide),this.calendarUrl=this.$calendar.data("url"),this.$calendarNPrev=this.element.find(this.options.calendarNPrev),this.$calendarNNext=this.element.find(this.options.calendarNNext),this.$calendarMonthSlider=this.element.find(this.options.calendarMonthSlider),this.$calendarSlider=this.element.find(this.options.calendarSlider),this.$dates=this.element.find(this.options.date),this.hidePopup=[],new t.Controls.UploadBlock(this.element.find(this.options.uploadBlock)),new t.Controls.UserStreamList(this.element.find(this.options.userStreamList)),this.$formFullName=new t.Controls.FormFullName(this.element.find(this.options.formFullName),{parent:this}),new t.Controls.GoogleCalendar(this.$calendar),this.$calendarMonthSlider.length){var e=this;this.$calendarMonthSlider.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:1,center:!0,margin:0,nav:!1,dots:!1,navRewind:!1,mouseDrag:!1,touchDrag:!1,startPosition:this.$calendarMonthSlider.find(".js-month-item.current-month").index(),onInitialized:function(){e.insertPoint(this.$element.find(".active .js-month-item"))},onTranslated:function(){e.updatePrevNext(),e.insertPoint(this.$element.find(".active .js-month-item"))}})}this.$calendarSlider.length&&this.$calendarSlider.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:1,center:!0,margin:0,nav:!1,dots:!1,navRewind:!1,mouseDrag:!1,touchDrag:!1,startPosition:this.$calendarMonthSlider.find(".js-month-item.current-month").parent().index()}),this.$certSliderSlides=this.element.find(this.options.certSliderSlides),this.$certSliderSlide=this.element.find(this.options.certSliderSlide),this.$certSliderSlides.length&&this.$certSliderSlides.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:4,center:!1,margin:20,nav:this.$certSliderSlide.length>4,navText:["",""],dots:!1,navRewind:!1}),this.updatePrevNext()},"{calendarNPrev} click":function(e){return e.hasClass("disabled")?!1:(this.$calendarMonthSlider.data("owlCarousel").prev(),this.$calendarSlider.data("owlCarousel").prev(),void 0)},"{calendarNNext} click":function(e){return e.hasClass("disabled")?!1:(this.$calendarMonthSlider.data("owlCarousel").next(),this.$calendarSlider.data("owlCarousel").next(),void 0)},"{formLink} click":function(e){this.$formFullName.populateStream(e.data("stream"))},"{forcedLink} click":function(e,t){t.preventDefault(),location.href=e.data("href")},"{date} mouseenter":function(e){var t=this.$dates.index(e);"undefined"!=typeof this.hidePopup[t]&&clearTimeout(this.hidePopup[t]),e.addClass("active");var a=e.find(".js-slides");a.length&&a.find(".js-slide").length>=1&&"undefined"==typeof a.data("owlCarousel")?a.owlCarousel({loop:!1,autoplay:!1,autoplayTimeout:0,autoplayHoverPause:!0,responsiveClass:!0,items:1,center:!0,margin:0,nav:a.find(".js-slide").length>1,navText:["",""],dots:!1,navRewind:!1,mouseDrag:a.find(".js-slide").length>1,touchDrag:a.find(".js-slide").length>1}):void 0!=a.data("owlCarousel")&&a.data("owlCarousel").onResize()},"{date} mouseleave":function(e){var t=this.$dates.index(e);this.hidePopup[t]=setTimeout(function(){e.removeClass("active")}.bind(this),300)},"{calendarSlide} mouseenter":function(){"undefined"!=typeof this.zIndex&&clearTimeout(this.zIndex),this.$calendarSlider.css({zIndex:"2"})},"{calendarSlide} mouseleave":function(){this.zIndex=setTimeout(function(){this.$calendarSlider.css({zIndex:"auto"})}.bind(this),300)},updatePrevNext:function(){var e=this.$calendarMonthSlider.data("owlCarousel");return void 0==e?!1:(this.$calendarSlide.length<=0||this.$calendarSlide.length-1==e._current?this.$calendarNNext.addClass("disabled"):this.$calendarNNext.removeClass("disabled"),0==e._current?this.$calendarNPrev.addClass("disabled"):this.$calendarNPrev.removeClass("disabled"),void 0)},insertPoint:function(t){this.$calendarSlide.addClass("active"),t.hasClass("load")?this._successPoint():(e.ajax({url:this.calendarUrl,type:"post",dataType:"json",data:{timestamp:t.data("timestamp")},success:this._successPoint.bind(this)}),t.addClass("load"))},_successPoint:function(t){void 0==t&&(t={}),void 0==this.dataAll&&(this.dataAll={}),this.dataAll=e.extend(!0,{},this.dataAll,t);for(var a in this.dataAll){var i={};void 0!=this.dataAll[a].LESSON&&void 0!=this.dataAll[a].LESSON.CONTENT&&(i=e.extend(!0,{},i,this.dataAll[a].LESSON.CONTENT)),void 0!=this.dataAll[a].WEBINAR&&void 0!=this.dataAll[a].WEBINAR.CONTENT&&(i=e.extend(!0,{},i,this.dataAll[a].WEBINAR.CONTENT));var n=this.$calendarSlider.find(".js-date").not(".disabled").filter('[data-timestamp="'+a+'"]').find(".js-insert-data");if(n.html(""),n.length){i=this._sortObject(i);var s=this._countPin(i);n.closest(".js-date").addClass("not-empty"),n.append(can.view("dayPopup",{data:i})),s.blue&&n.append(can.view("dayPin",{data:{COLOR:"blue",COUNT:s.blue}})),s.green&&n.append(can.view("dayPin",{data:{COLOR:"green",COUNT:s.green}})),s.gold&&n.append(can.view("dayPin",{data:{COLOR:"gold",COUNT:s.gold}})),s.end&&n.append(can.view("dayPin",{data:{COLOR:"",COUNT:s.end}}))}}this.$calendarSlide.removeClass("active")},forceCertLinks:function(){this.element.find(this.options.formLink).each(function(t,a){var i=e(a);i.addClass(this.options.forcedLinkClass),i.attr("href",i.data("href"))}.bind(this))},_sortObject:function(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(e[a]);return t.sort(function(e,t){return e.TIME_SORT-t.TIME_SORT}),t},_countPin:function(e){var t={end:0,blue:0,green:0,gold:0};for(var a in e)if(e.hasOwnProperty(a))switch(e[a].STATUS){case"END":t.end++;break;case"BLOCKED":t.gold++;break;case"NONE":"LESSON"==e[a].PROP?t.blue++:t.green++}return t}})}(jQuery,window.APP);
!function(o,s){"use strict";s.Controls.Page.ProfileSettings=can.Control.extend({defaults:{formPersonalData:".js-form-personal-data",formPersonalChangePassword:".js-form-personal-change-password"}},{init:function(){this.formData=new s.Controls.FormPersonalData(this.element.find(this.options.formPersonalData)),this.formPass=new s.Controls.FormPersonalChangePass(this.element.find(this.options.formPersonalChangePassword))}})}(jQuery,window.APP);
!function(e,t){"use strict";t.Controls.Page.StreamCourse=can.Control.extend({defaults:{leftSideBlock:".js-left-side-block",leftSideBlockCloseButton:".js-left-side-block-close",leftSideBlockOpenerButton:".js-left-side-block-opener",videoBlock:".js-video-block",activeClassForVideo:"open-panel-left",activeClassForLeftSide:"active",streamBlock:".js-stream-block",subscribeFreeBtn:".js-subscribe-free",formWebinar:".js-form-webinar",ajaxPopup:".js-popup-link-ajax",headerAuthLink:".js-header-auth-link",authLink:".js-auth-link"}},{init:function(){this.$leftSideBlock=this.element.find(this.options.leftSideBlock),this.$videoBlock=this.element.find(this.options.videoBlock),this.streamBlock=new t.Controls.StreamBlock(this.element.find(this.options.streamBlock)),this.player="live"==this.element.find(".js-main-container[data-template]").data("template")?new t.Controls.VideoPlayer(this.element.find(".js-video-player"),{streamBlock:this.streamBlock}):new t.Controls.VideoPlayerClappr(this.element.find(".js-video-player"),{streamBlock:this.streamBlock}),this.element.find(this.options.subscribeFreeBtn).each(function(){new t.Controls.SubscribeFree(e(this))}),this.initFancy()},initFancy:function(){this.element.find(this.options.ajaxPopup).each(function(){var i=e(this);i.fancybox({type:"ajax",ajax:{type:"POST"},href:i.attr("href"),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,wrapCSS:"undefined"!=typeof i.data("fancy-class")?i.data("fancy-class"):"qweqwe",padding:0,beforeLoad:function(){t.scrollY=window.scrollY},afterLoad:function(){setTimeout(function(){var e=this.outer.find("form");new t.Controls.FormStream(e),e.find("input[type=text], textarea").first().focus()}.bind(this),300)},afterClose:function(){setTimeout(function(){window.scrollTo(0,t.scrollY)},500);var e=this.outer.find("form"),i=this.outer.find(".js-inline-popup");e.length&&(1==e.data("clear-after")&&(e.find('input[type!="submit"][type!="hidden"][type!="checkbox"] , textarea').val(""),e.find('input[type="checkbox"]').prop("checked",!1)),t.Helpers.clearErrorForm(e)),i.length&&"reload"==i.data("reload")&&document.location.reload()},helpers:{overlay:{locked:!0},title:null}})})},"{leftSideBlockOpenerButton} click":function(){this.$leftSideBlock.addClass(this.options.activeClassForLeftSide),this.$videoBlock.addClass(this.options.activeClassForVideo)},"{leftSideBlockCloseButton} click":function(){this.$leftSideBlock.removeClass(this.options.activeClassForLeftSide),this.$videoBlock.removeClass(this.options.activeClassForVideo)},".fancybox-inner {authLink} click":function(i,o){o.preventDefault();var n=this.element.find(this.options.headerAuthLink);t.scrollY=0,e.fancybox.close(),n.click()}})}(jQuery,window.APP);
!function(e,t){"use strict";t.Controls.Page.StreamDetail=can.Control.extend({defaults:{teacherSlider:".js-teacher-slider",streamSelector:".js-stream-block",playlistBlock:".js-playlist-block",playlistBlockCloseButton:".js-playlist-block-close",playlistBlockOpenerButton:".js-playlist-block-opener",videoBlock:".js-video-block",activeClassForVideo:"open-panel-left",activeClassForPlaylist:"active",teacherBlock:".js-teacher-block",commentBlock:".js-comment-block",leftSideBlock:".js-left-side-block",leftSideBlockCloseButton:".js-left-side-block-close",leftSideBlockOpenerButton:".js-left-side-block-opener",activeClassForLeftSide:"active",streamBlock:".js-stream-block",formWebinar:".js-form-webinar",ajaxPopup:".js-popup-link-ajax",headerAuthLink:".js-header-auth-link",authLink:".js-auth-link"}},{init:function(){this.$playlistBlock=this.element.find(this.options.playlistBlock),this.$videoBlock=this.element.find(this.options.videoBlock),this.$teacherBlock=this.element.find(this.options.teacherBlock),void 0!==t.WEBINAR_DETAIL&&void 0!==t.WEBINAR_DETAIL.TEACHER?(this.$teacherBlock.html(can.view("teacherBlockInfo",{data:t.WEBINAR_DETAIL.TEACHER})),void 0!==t.WEBINAR_DETAIL.TEACHER.WORKS&&(this.$teacherBlock.append(can.view("teacherBlockSlider",{data:t.WEBINAR_DETAIL.TEACHER.WORKS})),this.$teacherBlock.find(this.options.teacherSlider).each(function(){new t.Controls.TeacherSlider(this)}))):this.$teacherBlock.remove(),new t.Controls.CommentBlock(this.element.find(this.options.commentBlock)),this.$leftSideBlock=this.element.find(this.options.leftSideBlock),this.$videoBlock=this.element.find(this.options.videoBlock),this.streamBlock=new t.Controls.StreamBlock(this.element.find(this.options.streamBlock)),this.player=new t.Controls.VideoPlayer(this.element.find(".js-video-player"),{streamBlock:this.streamBlock}),this.initFancy()},initFancy:function(){this.element.find(this.options.ajaxPopup).each(function(){var o=e(this);o.fancybox({type:"ajax",ajax:{type:"POST"},href:o.attr("href"),autoSize:!0,autoHeight:!0,autoWidth:!0,margin:0,wrapCSS:"undefined"!=typeof o.data("fancy-class")?o.data("fancy-class"):"qweqwe",padding:0,beforeLoad:function(){t.scrollY=window.scrollY},afterLoad:function(){setTimeout(function(){var e=this.outer.find("form");new t.Controls.FormStream(e),e.find("input[type=text], textarea").first().focus()}.bind(this),300)},afterClose:function(){setTimeout(function(){window.scrollTo(0,t.scrollY)},500);var e=this.outer.find("form"),o=this.outer.find(".js-inline-popup");e.length&&(1==e.data("clear-after")&&(e.find('input[type!="submit"][type!="hidden"][type!="checkbox"] , textarea').val(""),e.find('input[type="checkbox"]').prop("checked",!1)),t.Helpers.clearErrorForm(e)),o.length&&"reload"==o.data("reload")&&document.location.reload()},helpers:{overlay:{locked:!0},title:null}})})},".fancybox-inner {authLink} click":function(o,i){i.preventDefault();var l=this.element.find(this.options.headerAuthLink);t.scrollY=0,e.fancybox.close(),l.click()},"{leftSideBlockOpenerButton} click":function(){this.$leftSideBlock.addClass(this.options.activeClassForLeftSide),this.$videoBlock.addClass(this.options.activeClassForVideo)},"{leftSideBlockCloseButton} click":function(){this.$leftSideBlock.removeClass(this.options.activeClassForLeftSide),this.$videoBlock.removeClass(this.options.activeClassForVideo)}})}(jQuery,window.APP);
!function(t,l){"use strict";l.Controls.Page.StreamList=can.Control.extend({defaults:{}},{init:function(){this.initAjaxScroll()},initAjaxScroll:function(){this.ajaxScroll=new l.Controls.AjaxScroll(this.element.find(".js-scroll-page"),{callback:l.layout.setProductStatuses.bind(l.layout)})}})}(jQuery,window.APP);
!function(s,i,t){"use strict";i.Controls.Page.Faq=can.Control.extend({defaults:{collapseBlock:".js-collapse",collapseBlockClass:"active",collapsedBlock:".js-collapsed-block",sectionBlock:".js-faq-list-item",formSearch:".js-form-search",itemCol:".js-item-col",emptyListText:".js-empty-list-text",formQuestion:".js-form-question"}},{init:function(){this.$collapseBlocks=this.element.find(this.options.collapseBlock),this.$sectionBlocks=this.element.find(this.options.sectionBlock),this.$emptyListText=this.element.find(this.options.emptyListText),this.$itemCols=this.element.find(this.options.itemCol),this.form=new i.Controls.FormSearch(this.element.find(this.options.formSearch),{parent:this}),this.form=new i.Controls.FormQuestion(this.element.find(this.options.formQuestion)),this.$sectionBlocks.filter(":visible").length||(this.$emptyListText.show(),this.$itemCols.hide())},"{collapseBlock} click":function(i){i.hasClass(this.options.collapseBlockClass)?this.hideCollapseBlock(i):(this.$collapseBlocks.each(function(i,t){this.hideCollapseBlock(s(t))}.bind(this)),this.showCollapseBlock(i))},showCollapseBlock:function(s){s.addClass(this.options.collapseBlockClass),s.find(this.options.collapsedBlock).slideDown(200)},hideCollapseBlock:function(s){s.find(this.options.collapsedBlock).slideUp(200,function(){s.removeClass(this.options.collapseBlockClass)}.bind(this))},updateList:function(i){"all"==i&&(i=[],this.$collapseBlocks.each(function(t,o){var l=s(o),e=l.data("id");i[e]=e})),this.$collapseBlocks.each(function(o,l){var e=s(l),n=e.data("id");i[n]!==t?(e.slideDown(200),e.addClass("js-visible")):(e.slideUp(200),e.removeClass("js-visible"))}.bind(this)),this.$sectionBlocks.each(function(i,t){var o=s(t);o.find(this.options.collapseBlock).filter(".js-visible").length?(o.slideDown(200),o.addClass("js-visible")):(o.slideUp(200),o.removeClass("js-visible"))}.bind(this)),this.$sectionBlocks.filter(".js-visible").length?(this.$emptyListText.hide(),this.$itemCols.show()):(this.$emptyListText.show(),this.$itemCols.hide())}})}(jQuery,APP);
!function(t,i){"use strict";i.Controls.Page.About=can.Control.extend({defaults:{slider:".js-slides-person",slide:".js-slide",map:".js-map",icon:"/local/pictures/about/pin.png",eduItem:".js-education-item",mapOptions:{zoom:17,mapTypeControl:!1,scrollwheel:!1,draggable:!1,zoomControl:!1,scaleControl:!1,disableDoubleClickZoom:!0,disableDefaultUI:!0,marker:".js-marker",clickable:!1}}},{init:function(){this.$slider=this.element.find(this.options.slider),this.$map=this.element.find(this.options.map),this.$slider.length&&this.initSlider(this.$slider),google.maps.Map.prototype.setCenterWithOffset=function(t,i,e){var n=this,o=new google.maps.OverlayView;o.onAdd=function(){var o=this.getProjection(),s=o.fromLatLngToContainerPixel(t);s.x=s.x+i,s.y=s.y+e,n.setCenter(o.fromContainerPixelToLatLng(s))},o.draw=function(){},o.setMap(this)},this.$map.length&&this.initMap(this.$map),setTimeout(function(){this.element.find(this.options.eduItem).each(function(i,e){var n=t(e),o=n.find(".line");setTimeout(function(){o.css({stroke:"url(#linear-"+(i+1)+")"}),n.addClass("active"),this.animateLines(o)}.bind(this),1e3*i)}.bind(this))}.bind(this),1e3)},initSlider:function(t){t.owlCarousel({loop:!1,autoplay:!1,items:1,margin:20,center:!1,nav:!1,dots:t.find(this.options.slide).length>1,navRewind:!1,autoHeight:!1})},initMap:function(t){if("undefined"==typeof t.data("pin-x")||"undefined"==typeof t.data("pin-y"))return!1;this.options.mapOptions.center=new google.maps.LatLng(t.data("pin-x"),t.data("pin-y")),this.map=new google.maps.Map(t.get(0),this.options.mapOptions);var i=new google.maps.LatLng(t.data("pin-x"),t.data("pin-y"));new google.maps.Marker({position:i,clickable:this.options.mapOptions.clickable,map:this.map,icon:this.options.icon}),this.map.setCenterWithOffset(this.options.mapOptions.center,-208,-45)},animateLines:function(t){t.animate({"stroke-dashoffset":0},1e3)}})}(jQuery,APP);
!function(n,t){"use strict";t.Controls.Application=can.Control.extend({init:function(){t.layout=new t.Controls.Layout(this.element),this.initPageController()},initPageController:function(){var n=can.capitalize(can.camelize(this.element.data("page-type")));t.Controls.Page[n]&&new t.Controls.Page[n](this.element)},initCommonController:function(){}}),n(function(){new t.Controls.Application(n("body"))})}(jQuery,window.APP);